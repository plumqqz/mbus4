select mbus4.drop_queue('work')

select mbus4.create_queue('work',512)
select mbus4.create_consumer('every100','work',$$ (data->'key') ~ $RE$^\d+$RE$ and ((data->'key')::integer%100)=0 $$)
commit

--truncate table clog

select * from mbus4.consumen_work_by_default(10000)
select * from mbus4.consumen_work_by_every100(10000)

select count(*) from mbus4.qt$work

with tq as(
select src, key, lead(key) over(order by key) as next from clog where src in ('#','N')
)
select * from tq where key+1<>next
order by key

with tq as(
select src, key, lead(key) over(order by key) as next from clog where src in('100','N100')
)
select * from tq where key+100<>next
order by key

select count(*) from clog